# 평창 모나리조트 기반 스키 코스 지형 생성 프롬프트 (Godot 4)

너는 **Godot 4로 스키/보드 게임을 만드는 시니어 게임 프로그래머**다.  
아래 요구사항을 만족하는 **3D 스키 코스 지형 + 종점 처리 로직**을 설계하고, Godot 4에서 바로 쓸 수 있는 예시 코드를 작성해줘.

---

## 1. 전체 컨셉

- 실제 참고 대상: **평창 모나리조트**의 긴 코스를 느슨하게 참고한 코스
- 게임 내 구현 목표:
  - **상단 → 중단 → 하단**으로 이어지는 **단일 롱런 코스 1개**
  - 전체적으로 **완만하지만 확실히 내려가는 스키 슬로프**
  - 지형은 **굴곡 없이 매끈한 면**으로, 그림자가 잘 보이도록 단순한 형태 유지
  - 코스 외 배경 요소는 **최소한으로 유지 (사실상 없음)**

---

## 2. 좌표계 & 스케일

Godot 4의 기본 3D 좌표계를 사용해줘.

- **좌표계**
  - `Y+` : 위쪽(Up)
  - `Z-` : 전진(플레이어가 내려가는 방향 기준)
  - `X` : 좌우
- **스케일 가정**
  - `1 Godot 유닛 ≈ 1 미터`
- **코스 대략 길이 (예시 값으로 구현)**
  - 상단 직선 구간: 약 500m
  - 중단 직선 구간: 약 500m
  - 하단 직선 구간: 약 500m
  - 전체 길이: 약 1500m
- **폭**
  - 상단: 약 40m
  - 중단: 약 30m
  - 하단: 약 50m

이 값들은 코드에서 상수로 정의하고, 나중에 쉽게 조정할 수 있도록 구현해줘.

---

## 3. 코스 구조 (지형 레이아웃)

### 3.1. 구간 개요

코스는 아래처럼 **3개의 직선 구간**이 이어진 구조야:

1. **상단 구간 (Top)**
   - 특징: **쭉 뻗은 직선**, **넓은 폭**
   - 길이: 약 500m
   - 폭: 약 40m
   - 경사: **15~20도** 정도로 아래 방향으로 기울어짐

2. **중단 구간 (Middle)**
   - 상단과 중단 사이에 **왼쪽으로 약 90도 턴**
   - 턴 이후: 다시 **쭉 뻗은 직선**, **중간 폭**
   - 길이: 약 500m
   - 폭: 약 30m
   - 경사: 상단과 비슷한 15~20도

3. **하단 구간 (Bottom)**
   - 중단과 하단 사이에 **오른쪽으로 약 180도 턴**
     - 즉, 큰 U자 모양으로 방향 전환
   - 턴 이후: **쭉 뻗은 직선**, **넓은 폭**
   - 길이: 약 500m
   - 폭: 약 50m
   - 하단 끝에 **종점 표시용 파란 직사각형**이 놓임

### 3.2. 구현 형태

- 지형은 **여러 개의 PlaneMesh 또는 커스텀 Mesh**를 이어 붙인 형태로 만들어줘.
- 각 구간은 다음과 같이 구성:
  - 직선 구간: 넓고 긴 직사각형 메쉬
  - 턴 구간: 자연스럽게 이어지도록 **회전/이동된 직사각형 메쉬들** 또는 간단한 곡선 느낌의 메쉬 조합
- 지형 표면은:
  - **눈 텍스처 1장**만 써도 됨 (알베도만 있는 단순 텍스처)
  - 노멀맵/러프니스는 최소한으로, 퍼포먼스와 단순함 위주

---

## 4. 아트 스타일 & 환경

- **카메라/뷰 느낌**
  - 카메라는 **지면에서 약간 위**, 뒤에서 따라오는 3인칭 뷰
  - 전체적인 시야각/구도를 포함해, 슬로프의 **경사(15~20도)** 가 자연스럽게 느껴지도록 구성
- **시간대/날씨**
  - 시간: **정오**
  - 날씨: **맑음, 구름 거의 없음**
- **지형 상태**
  - 굴곡 없는 **매끈한 그루밍 슬로프** 느낌
  - 지형 위에 그림자가 선명하게/자연스럽게 드리워질 수 있도록 평탄하게 유지
- **배경 요소**
  - 요구사항: **배경 요소 없음**
  - 즉, 산/나무/리프트 타워 등은 배제하고, 지형과 하늘 정도만 있는 심플한 씬

환경은 최소한의 요소만 사용해서,
- DirectionalLight3D 1개
- WorldEnvironment 1개 (하늘만 있는 단순 SkyMaterial)
정도로 구성해줘.

---

## 5. 종점(Goal) 처리: 파란 직사각형 + 게임 상태값 변경

### 5.1. 파란 직사각형 오브젝트

하단 직선 구간의 맨 끝에 **종점을 표시하는 파란색 직사각형**을 만들어줘.

- 형태:
  - 지형 위에 살짝 붙어 있는 **평평한 Rect/Plane**
  - 대략 크기: 폭 10m × 길이 5m 정도 (눈에 잘 띄는 수준)
- 위치:
  - 하단 직선의 끝부분 중앙에 배치
- 머티리얼:
  - 알베도 색: **선명한 파란색**
  - 눈 지형과 확실히 구분되도록 하이라이트 느낌

### 5.2. 종점 충돌 처리

스키어(플레이어)가 파란 직사각형 위로 올라갔을 때:

- 게임의 상태값이 `게임 종료/클리어` 로 변경되어야 함.
- 구현 방식은 예를 들어 다음 중 하나로 해줘:
  - 씬 트리 어딘가에 `GameState` 노드가 있고, 거기에 `is_level_cleared: bool` 같은 변수가 있어 이 값을 `true`로 바꾸기
  - 또는 `LevelManager` 노드의 `finish_level()` 함수를 호출하기

구체 예시는:

- 플레이어:
  - 타입: `CharacterBody3D`
  - 그룹: `"player"` 그룹에 등록되어 있다고 가정
- 종점 오브젝트:
  - `Area3D` + `CollisionShape3D` 로 구성
  - `area.body_entered(body: Node)` 시그널에서:
    - `if body.is_in_group("player"):` 조건으로 체크 후
    - `GameState.is_level_cleared = true` 또는 `LevelManager.finish_level()` 호출

---

## 6. Godot 4 씬 구조 설계

아래는 예시 씬 구조야. 이와 비슷하게 구성해줘:

- `Main.tscn`
  - `Main` (Node3D)
    - `Course` (Node3D)
      - `TopSegment` (MeshInstance3D + CollisionShape3D)
      - `MiddleTurn` (MeshInstance3D + CollisionShape3D)
      - `MiddleSegment` (MeshInstance3D + CollisionShape3D)
      - `BottomTurn` (MeshInstance3D + CollisionShape3D)
      - `BottomSegment` (MeshInstance3D + CollisionShape3D)
      - `GoalArea` (Area3D)
        - `GoalMesh` (MeshInstance3D, 파란 직사각형)
        - `CollisionShape3D`
    - `Player` (CharacterBody3D)  ← 이미 만들어져 있다고 가정해도 됨
    - `DirectionalLight3D`
    - `WorldEnvironment`
    - `LevelManager` (Node or custom script)

`Course` 노드에 붙는 스크립트에서 각 세그먼트를 **코드로 생성/배치**해줘도 좋고,  
씬 상에서 미리 배치한 노드를 스크립트에서 위치/각도만 계산해줘도 좋아.

---

## 7. 그림자 설정

지형 위에서 **플레이어, 기타 오브젝트의 그림자가 잘 보이도록** 최소 설정을 해줘:

- `DirectionalLight3D`:
  - `shadow_enabled = true`
  - 적당한 `directional_shadow_max_distance` 값 설정 (코스 전체가 그림자 범위 안에 들어오도록)
- 지형/플레이어 Mesh:
  - `Cast Shadow: On` (또는 On/Double-Sided 적절히 설정)

---

## 8. 요구 출력물

아래 내용을 모두 포함해서 답변해줘.

1. **설계 요약 텍스트**
   - 위 요구사항을 만족하는 코스 구조를 글로 정리 (각 구간의 위치/회전/길이/폭/경사 설명)
2. **Godot 4용 GDScript 예시**
   - `Course.gd`:
     - 상단/중단/하단 세그먼트 메쉬를 코드로 생성 및 배치하거나,
     - 이미 존재하는 노드들의 `transform`을 계산해서 설정하는 로직
   - `GoalArea` 관련 스크립트:
     - `Area3D`의 `body_entered` 핸들러에서 플레이어 진입 감지 후 게임 상태값 변경
   - `LevelManager.gd` (또는 `GameState.gd`) 예시:
     - `is_level_cleared` 플래그 및 `finish_level()` 메서드 구현 예시
3. **씬 세팅 절차**
   - Godot 에디터에서:
     - 메인 씬 생성
     - Course/Player/Light/WorldEnvironment/LevelManager 배치 순서
   - 필요한 경우:
     - 에디터에서 노드에 스크립트 연결하는 방법 간단 가이드

코드는 **Godot 4 기준 API** 만 사용해줘.  
가능하면, 나중에 슬로프 길이/폭/경사/턴 각도를 쉽게 조정할 수 있도록 상수/파라미터화해서 작성해줘.
